version: '3.9'
services:
  baai-bge-m3:
    image: ghcr.io/huggingface/text-embeddings-inference:1.5
    container_name: baai-bge-m3
    runtime: nvidia
    volumes:
      - ${DATA_VOLUME:-./docker-compose-data}:/data
    ports:
      - "8080:80"
    environment:
      - HUGGINGFACE_HUB_CACHE=/data
      - PORT=80
      - USE_FLASH_ATTENTION=True
    command: >
      --model-id BAAI/bge-m3
      --max-client-batch-size 50000
      --payload-limit 100000000

  nomic-embed-text-v1-5:
    image: ghcr.io/huggingface/text-embeddings-inference:1.5
    container_name: nomic-embed-text-v1-5
    runtime: nvidia
    volumes:
      - ${DATA_VOLUME:-./docker-compose-data}:/data
    ports:
      - "8082:80"
    environment:
      - HUGGINGFACE_HUB_CACHE=/data
      - PORT=80
      - USE_FLASH_ATTENTION=True
    command: >
      --model-id nomic-ai/nomic-embed-text-v1.5
      --max-client-batch-size 50000
      --payload-limit 100000000

  alibaba-qwen2-7b-instruct:
    image: ghcr.io/huggingface/text-embeddings-inference:1.5
    container_name: alibaba-qwen2-7b-instruct
    runtime: nvidia
    volumes:
      - ${DATA_VOLUME:-./docker-compose-data}:/data
    ports:
      - "8083:80"
    environment:
      - HUGGINGFACE_HUB_CACHE=/data
      - PORT=80
      - USE_FLASH_ATTENTION=True
    command: >
      --model-id Alibaba-NLP/gte-Qwen2-7B-instruct
      --max-client-batch-size 50000
      --payload-limit 100000000